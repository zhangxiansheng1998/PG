[
  {
    "testDataId": "Refundv2_NE_NDHK-4913",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-void",
      "frontend_cybsDB-transaction_log",
      "frontend_cybsDB-capture",
      "frontend_cybsDB-refund",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "150",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "Y",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "150",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "Transaction Authorization Succeeded",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "Y",
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "void": {
      "amt": "50",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Partial void is not allowed",
        "signature": true,
        "errorCode": "NE3018",
        "errorDesc": "Partial void is not allowed"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_log": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "booking_id",
              "amount",
              "response_code",
              "merchantid",
              "user_data_22",
              "txn_type",
              "user_data_45",
              "currency",
              "txn_status",
              "auth_code",
              "user_data_25",
              "channel_type",
              "stage",
              "user_data_3",
              "user_data_16"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "amount": "1.5000",
              "response_code": "100",
              "auth_code": "831000",
              "booking_id": "Refund_NE",
              "user_data_25": "null",
              "user_data_16": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
              "stage": "Transaction Authorization Succeeded",
              "merchantid": "NTT_AUTO",
              "txn_type": "AUTH",
              "user_data_45": "AUTH",
              "user_data_3": "150",
              "currency": "HKD",
              "channel_type": "cybs",
              "txn_status": "OK"
            }
          ]
        }
      }
    },
    "capture": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "capture",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "refund": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": []
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-11 17:11:28,201 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-12) 940936777: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940936777, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=2.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-11 17:11:29,848 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-12) 940936777: Authorization response from cybs to NTT with HKD[ccAuthReply_reconciliationID=5918666882186290004012, purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=2, ccAuthReply_reasonCode=120, decision=ACCEPT, ccAuthReply_amount=0.00, merchantReferenceCode=940936777, requestID=5918666882186290004012, ccAuthReply_authorizedDateTime=2020-06-11T09:11:28Z, ccAuthReply_authorizationCode=831000, reasonCode=120]"
            },
            {
              "raw": "2020-06-11 17:11:29,854 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-12) CybersourcePaymentServiceImpl -  update transaction 940936777"
            },
            {
              "raw": "2020-06-11 17:11:29,885 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-12) #test39 - 940936777 Cvv removal : OK"
            },
            {
              "raw": "2020-06-11 17:11:29,885 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-12) Update remove cvv log table - nttrefid: 940936777"
            },
            {
              "raw": "2020-06-11 17:11:30,853 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-12) 940936777: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=200, txncurr=HKD, txnid=test39, nttrefid=940936777, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=120, date=2020-06-11 17:11:28, signature=6ab1a471e7ad4a02e4e62b1c4168c872b9ad05002e8776d31b7f89330af2b0f39ef6edb9dd4d20cd97c5ed0f3b31cd3fa07ece217c836526d239ac8e0ca0ef9a, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-11 17:11:30,858 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread2) Callback Json: {\"amt\":\"200\",\"txncurr\":\"HKD\",\"txnid\":\"test39\",\"nttrefid\":\"940936777\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"120\",\"date\":\"2020-06-11 17:11:28\",\"signature\":\"6ab1a471e7ad4a02e4e62b1c4168c872b9ad05002e8776d31b7f89330af2b0f39ef6edb9dd4d20cd97c5ed0f3b31cd3fa07ece217c836526d239ac8e0ca0ef9a\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-11 17:11:43,949 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-26) 940936777: Refund request from NTT_AUTO to NTT with 733914066@210.3.198.58:NttRequest [refundrefnum=733914066, login=NTT, pass=XXX, nttrefid=940936777, amt=50, signature=8e274429d7081766574b8cd328c3fedc14db247d5141fc6798b69868270d2ba290ea7899e3ab86b5b2f2268d4de27fe24c72f131a2664d7ecd7723eec94f8ac1, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 17:11:43,968 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-26) 940936777: Refund response from NTT to NTT_AUTO with 733914066@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid API credentials, signature=085b3d2fb6ae6e490f6873280d36741a8ad8bf9b26964c18ab9835e2217c3f41dd7b8600d4c98abfecc9b48a66b8fae8efa6da89dfba06ba116be82efb5e2784, isEnableRetry=null, errorCode=NE0100, errorDesc=Invalid API credentials]"
            },
            {
              "raw": "2020-06-11 17:11:55,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-9) 940936777: Refund request from NTT_AUTO to NTT with 235731495@210.3.198.58:NttRequest [refundrefnum=235731495, login=NTT, pass=XXX, nttrefid=940936777, amt=50, signature=6dcec6c60471e951366cceb94005f931824a567cd4728100ae8db28f43f0eeb0e1d4ce5654bb2f48561a2964a472e8d26ecdf8e70e6ed5539f15ffecb76aeabc, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 17:11:56,026 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-9) 940936777: Refund response from NTT to NTT_AUTO with 235731495@210.3.198.58:NttResponse [respcode=01, respdesc=Partial void is not allowed, signature=c46dfcea510ba677b88bd743aca55ff974eb48b2baf1f8488e70e963cea3f441ea5258c1900eeb90ee5ab41022f93eba158125a8af1acbed3af8a105f020c6ef, isEnableRetry=null, errorCode=NE3018, errorDesc=Partial void is not allowed]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4912",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-void",
      "refundRequestV2-void1",
      "frontend_cybsDB-transaction_log",
      "frontend_cybsDB-capture",
      "frontend_cybsDB-refund",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "150",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "Y",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "150",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "Transaction Authorization Succeeded",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "Y",
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "void": {
      "amt": "150",
      "refundMode": "VOID",
      "expectedResult": {
        "amt": "150",
        "txncurr": "HKD",
        "txnid": true,
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "signature": "ccfb388519a4fb525b25c12299b82f8bc2741e2cf117906781395ed5cb576e1f772bcc92b58befecb7d9c8891ca5bc3221a4dc38e0e95fad16ce077dbe05cbf3",
        "refundRefNum": true
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "refundMode",
        "amt"
      ]
    },
    "void1": {
      "amt": "150",
      "refundMode": "VOID",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Nonvoidable transaction status - voided transaction",
        "signature": "978c4be282546bed2bd5e8a3fdfef74b9f20ecc1266609f2cf1c1f455ee796d2481a5fdb46dccb2d0d5444e684f0aed4923fdb7e6b845d9a5070194d889edbdf",
        "errorCode": "NE4023",
        "errorDesc": "Nonvoidable transaction status - voided transaction"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_log": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "booking_id",
              "amount",
              "response_code",
              "merchantid",
              "user_data_22",
              "txn_type",
              "user_data_45",
              "currency",
              "txn_status",
              "auth_code",
              "user_data_25",
              "channel_type",
              "stage",
              "user_data_3",
              "user_data_16"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "amount": "1.5000",
              "response_code": "100",
              "auth_code": "831000",
              "booking_id": "Refund_NE",
              "user_data_25": "Fully_Refunded",
              "user_data_16": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
              "stage": "Transaction Authorization Succeeded",
              "merchantid": "NTT_AUTO",
              "txn_type": "AUTH",
              "user_data_45": "AUTH",
              "user_data_3": "150",
              "currency": "HKD",
              "channel_type": "cybs",
              "txn_status": "OK"
            }
          ]
        }
      }
    },
    "capture": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "capture",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "refund": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "refund_amt",
              "is_partial_refund",
              "txn_amt",
              "pending_amt",
              "resp_code",
              "resp_msg",
              "rrn",
              "refund_mode",
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "txn_amt": "1.5000",
              "pending_amt": "0.0000",
              "refund_mode": "VOID",
              "is_partial_refund": "0",
              "resp_code": "00",
              "refund_amt": "1.5000",
              "currency": "HKD",
              "resp_msg": "SUCCESS",
              "rrn": true
            }
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-11 17:58:19,621 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-32) 940936869: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940936869, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-11 17:58:20,870 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-32) 940936869: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940936869, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5918694992356473604011, ccAuthReply_amount=1.00, requestID=5918694992356473604011, ccAuthReply_authorizedDateTime=2020-06-11T09:58:19Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-11 17:58:20,877 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-32) CybersourcePaymentServiceImpl -  update transaction 940936869"
            },
            {
              "raw": "2020-06-11 17:58:20,902 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-32) #test39 - 940936869 Cvv removal : OK"
            },
            {
              "raw": "2020-06-11 17:58:20,902 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-32) Update remove cvv log table - nttrefid: 940936869"
            },
            {
              "raw": "2020-06-11 17:58:21,864 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-32) 940936869: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test39, nttrefid=940936869, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-11 17:58:19, signature=120994c7c09f888ef1a156f8d3f3a5814a9d00ed95f194f961c7639f87985b67ec0e5b0e8128ef572615e7e2a80d2e8146ef8d91759c0931123ccbb628b52535, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-11 17:58:21,865 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread2) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test39\",\"nttrefid\":\"940936869\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-11 17:58:19\",\"signature\":\"120994c7c09f888ef1a156f8d3f3a5814a9d00ed95f194f961c7639f87985b67ec0e5b0e8128ef572615e7e2a80d2e8146ef8d91759c0931123ccbb628b52535\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-11 17:58:34,635 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-10) 940936869: Refund request from NTT_AUTO to NTT with 6340462979@210.3.198.58:NttRequest [refundrefnum=6340462979, login=NTT, pass=XXX, nttrefid=940936869, amt=50, signature=a74313a61084fa8e246815cb3815065dcbf1dbdcb6c7dbbba0d225e62dd756670a2012802f2b41169d4a636ead91db7c4ab166bbbd75c716ee27a024be733726, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 17:58:34,664 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-10) 940936869: Refund response from NTT to NTT_AUTO with 6340462979@210.3.198.58:NttResponse [respcode=01, respdesc=Partial void is not allowed, signature=a2a61e12a714acd651b9c00205b3639064060801ba5b799b2bc7872d587e8af57cdf5124079294de7c7dd51a122f51c24c062c076d618b644758b502118aec6a, isEnableRetry=null, errorCode=NE3018, errorDesc=Partial void is not allowed]"
            },
            {
              "raw": "2020-06-11 17:58:43,100 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940936869: Refund request from NTT_AUTO to NTT with 6065042979@210.3.198.58:NttRequest [refundrefnum=6065042979, login=NTT, pass=XXX, nttrefid=940936869, amt=150, signature=22c564df841a401916eaee3f2cb5cc1c24c78e82ee6b0f5c10dba54ae92540e35e81416ea722caa788c2a5182134a2e34612f5a371c2ae88ce6a8b71cfcb2580, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 17:58:43,128 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940936869: Refund response from NTT to NTT_AUTO with 6065042979@210.3.198.58:NttResponse [respcode=01, respdesc=Partial void is not allowed, signature=bfcd9123af1cc19e1d1d95c9d930b23fbe03ab14d9209b917e6e38b5f9085d549ed7e8d713ef91b29267304bb00b40a3733c83725e0c5de1a6d7f688c9e86206, isEnableRetry=null, errorCode=NE3018, errorDesc=Partial void is not allowed]"
            },
            {
              "raw": "2020-06-11 17:59:06,446 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-18) 940936869: Refund request from NTT_AUTO to NTT with 588087072@210.3.198.58:NttRequest [refundrefnum=588087072, login=NTT, pass=XXX, nttrefid=940936869, amt=100, signature=03aee97eb34a2ea956aed5db4650ea815d65b1b66cbf564d4b88634a678874468a91ece1d451a975851e4d6f40b1345e20c935d6445d25b4251bc8cc7e708d57, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 17:59:06,470 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-18) start refund record processing 940936869"
            },
            {
              "raw": "2020-06-11 17:59:06,477 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-18) 940936869"
            },
            {
              "raw": "2020-06-11 17:59:06,504 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-18) Refunddataarray::::::::940936869"
            },
            {
              "raw": "2020-06-11 17:59:06,521 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-18) 940936869: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5918694992356473604011, merchantReferenceCode=588087072, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-11 17:59:07,751 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-18) 940936869: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-11T09:59:06Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=588087072, requestID=5918695461226160904012, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-11 17:59:07,766 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-18) finish refund record processing 940936869"
            },
            {
              "raw": "2020-06-11 17:59:07,771 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-18) 940936869: Refund response from NTT to NTT_AUTO with 588087072@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test39, nttrefid=940936869, respcode=00, respdesc=success, proc_code=100, signature=a69adc6d62b894bce6fbd9ae7f0af9931328bd1ec9c9237904ff6a43d9f9ed704857ac90ca35ddc8cef0f5db82dfb3e6f42fbd6503db558dff41586230e27506, isEnableRetry=null, refundRefNum=588087072, ]"
            },
            {
              "raw": "2020-06-11 17:59:15,386 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-17) 940936869: Refund request from NTT_AUTO to NTT with 4390745320@210.3.198.58:NttRequest [refundrefnum=4390745320, login=NTT, pass=XXX, nttrefid=940936869, amt=100, signature=8bee67205b29d0322ca35d34824751a0e8ec38d113ca4b0d6593fe9beefd4dd68d73855fb80fcf6618a457d0d74e78caba2f1be08902d8e81634947ff4aaf011, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 17:59:15,414 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-17) 940936869: Refund response from NTT to NTT_AUTO with 4390745320@210.3.198.58:NttResponse [respcode=01, respdesc=Nonvoidable transaction status - voided transaction, signature=d6e623a0238963e93deb9a456edc7d9f83b1c4354c16609b83eca506da63777038f8b4c7f8a33b8fce1c75e68eb64fe769c14258c375c8a18170589fbe370781, isEnableRetry=null, errorCode=NE4023, errorDesc=Nonvoidable transaction status - voided transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4911",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-transaction_logtable",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "150",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "150",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "refundMode": "VOID",
      "amt": "150",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Nonvoidable transaction status - captured transaction",
        "signature": true,
        "errorCode": "NE4024",
        "errorDesc": "Nonvoidable transaction status - captured transaction"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_logtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "booking_id",
              "amount",
              "response_code",
              "merchantid",
              "user_data_22",
              "txn_type",
              "user_data_45",
              "currency",
              "txn_status",
              "auth_code",
              "user_data_25",
              "channel_type",
              "stage",
              "user_data_3",
              "user_data_16",
              "user_data_43"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "amount": "1.5000",
              "response_code": "100",
              "auth_code": "831000",
              "booking_id": "Refund_NE",
              "user_data_25": "null",
              "user_data_16": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
              "stage": "Transaction Completed",
              "merchantid": "NTT_AUTO",
              "txn_type": "DIRECT",
              "user_data_45": "PURCHASE",
              "user_data_3": "150",
              "currency": "HKD",
              "user_data_43": "null",
              "channel_type": "cybs",
              "txn_status": "OK"
            }
          ]
        }
      }
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-11 17:54:38,296 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-27) 940936864: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940936864, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-11 17:54:39,581 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-27) 940936864: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940936864, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5918692779146421604011, ccAuthReply_amount=1.00, requestID=5918692779146421604011, ccAuthReply_authorizedDateTime=2020-06-11T09:54:38Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-11 17:54:39,588 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-27) CybersourcePaymentServiceImpl -  update transaction 940936864"
            },
            {
              "raw": "2020-06-11 17:54:39,588 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorCaptureServiceImpl] (default task-27) CybersourceCaptureServiceImpl - CaptureEntity [id=null, transactionId=940936864, captureAmt=1.00, partialCapture=false, txnAmt=1.00, respCode=02, respMsg=EN, accNo=411111XXXXXX1111, merchantId=NTT, rrn=5918692779146421604011, captureMode=AUTO, ]"
            },
            {
              "raw": "2020-06-11 17:54:39,600 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-27) 940936864: Capture request from NTT to cybs with HKD[purchaseTotals_currency=HKD, merchantReferenceCode=940936864, ccCaptureService_run=true, ccCaptureService_authRequestID=5918692779146421604011, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-11 17:54:40,090 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-27) 940936864: Capture response from cybs to NTT with HKD[purchaseTotals_currency=HKD, decision=ACCEPT, requestID=5918692784466623504008, merchantReferenceCode=940936864, ccCaptureReply_reconciliationID=5918692779146421604011, reasonCode=100, ccCaptureReply_requestDateTime=2020-06-11T09:54:38Z, ccCaptureReply_reasonCode=100, ccCaptureReply_amount=1.00]"
            },
            {
              "raw": "2020-06-11 17:54:40,090 INFO  [com.nttdata.hk.processor.cybersource.serivce.Impl.CybersourceCaptureServiceImpl] (default task-27) update captureEntity CaptureEntity [id=97411, transactionId=940936864, captureAmt=1.00, partialCapture=false, txnAmt=1.00, respCode=00, respMsg=OK, accNo=411111XXXXXX1111, merchantId=NTT, rrn=5918692784466623504008, captureMode=AUTO, createdAt=2020-06-11 17:54:39.588, updatedAt=2020-06-11 17:54:39.588]"
            },
            {
              "raw": "2020-06-11 17:54:40,131 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-27) #test39 - 940936864 Cvv removal : OK"
            },
            {
              "raw": "2020-06-11 17:54:40,131 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-27) Update remove cvv log table - nttrefid: 940936864"
            },
            {
              "raw": "2020-06-11 17:54:41,115 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-27) 940936864: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test39, nttrefid=940936864, respcode=00, respdesc=Transaction Completed, proc_code=100, date=2020-06-11 17:54:38, signature=120994c7c09f888ef1a156f8d3f3a5814a9d00ed95f194f961c7639f87985b67ec0e5b0e8128ef572615e7e2a80d2e8146ef8d91759c0931123ccbb628b52535, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, captureId=97411, manualCapture=N, manualCaptureStatus=F, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-11 17:54:41,121 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread8) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test39\",\"nttrefid\":\"940936864\",\"respcode\":\"00\",\"respdesc\":\"Transaction Completed\",\"proc_code\":\"100\",\"date\":\"2020-06-11 17:54:38\",\"signature\":\"120994c7c09f888ef1a156f8d3f3a5814a9d00ed95f194f961c7639f87985b67ec0e5b0e8128ef572615e7e2a80d2e8146ef8d91759c0931123ccbb628b52535\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"captureId\":\"97411\",\"manualCapture\":\"N\",\"manualCaptureStatus\":\"F\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-11 17:54:52,623 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-32) 940936864: Refund request from NTT_AUTO to NTT with 5737786875@210.3.198.58:NttRequest [refundrefnum=5737786875, login=NTT, pass=XXX, nttrefid=940936864, amt=50, signature=b988565984b89b0f87c97681149e106240ac718c862e292fdfdc7300e8493264575499dc2754bd380a318909de2f261c1b9331c96349daa3e9a554ae79545ff5, isEnableRetry=false, refundMode={{VOID}}, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 17:54:52,648 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-32) 940936864: Refund response from NTT to NTT_AUTO with 5737786875@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid parameter - refundMode, signature=f49fb1c6e1cc2b56c8edb60573debf41a1c2e60062f1845ba89c513fc7a44471c20f6f914112befc6ad0219ec0c2c86297f0533fa7ed42f0f75f81a409ef1418, isEnableRetry=null, errorCode=NE1079, errorDesc=Invalid parameter - refundMode]"
            },
            {
              "raw": "2020-06-11 17:55:05,139 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-3) 940936864: Refund request from NTT_AUTO to NTT with 4611819396@210.3.198.58:NttRequest [refundrefnum=4611819396, login=NTT, pass=XXX, nttrefid=940936864, amt=50, signature=1edcbb5e984071dc69ecccaf990b9abf1dfe135517d92d1538c911dfc8f5f0a1a4196c3534f9cbd0c3bc1b636ff01614ed604adb82c16f140b0cf8ed389e6760, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 17:55:05,166 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-3) 940936864: Refund response from NTT to NTT_AUTO with 4611819396@210.3.198.58:NttResponse [respcode=01, respdesc=Nonvoidable transaction status - captured transaction, signature=faea794ef4209f560abd4cb0a36f0059ea53c38f9623a10c435f9039699676315aebd75330d9c630f7331a8fafe55dc035c0cc76cbc7e21ab8f4c4d490144d60, isEnableRetry=null, errorCode=NE4024, errorDesc=Nonvoidable transaction status - captured transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4906",
    "OD": "QA_Automation",
    "merchantId": "nttm4auto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-capturetable",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "200",
      "txnid": "Refund_NE",
      "txncurr": "MMK",
      "carddata": "wtuY0ewq97XfDOGiMxsS5hALHe9uhoHmfy06gSpxYAM=|CardHolder|CC|OTHER",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "od": "od - recurring",
      "merchantDescriptor": "TESTIGN1.13.1",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "migs",
      "udf1": "网络_transaction",
      "udf2": "网络",
      "udf3": "网络",
      "udf4": "网络",
      "udf5": "网络",
      "expectedResult": {
        "amt": "200",
        "channelType": "migs",
        "respcode": "01",
        "respdesc": "Unauthorized request"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "channelType"
      ]
    },
    "refund": {
      "refundMode": "VOID",
      "amt": "200",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Nonvoidable transaction status - failed transaction",
        "signature": true,
        "errorCode": "NE4022",
        "errorDesc": "Nonvoidable transaction status - failed transaction"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "capturetable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "capture",
            "columnNames": [
              "capture_amt",
              "currency",
              "pending_amt",
              "resp_code",
              "resp_msg",
              "capture_mode",
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-11 18:09:22,299 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-25) 940936873: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940936873, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=2.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-11 18:09:23,534 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-25) 940936873: Authorization response from cybs to NTT with HKD[ccAuthReply_reconciliationID=5918701618976797804011, purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=2, ccAuthReply_reasonCode=120, decision=ACCEPT, ccAuthReply_amount=0.00, merchantReferenceCode=940936873, requestID=5918701618976797804011, ccAuthReply_authorizedDateTime=2020-06-11T10:09:22Z, ccAuthReply_authorizationCode=831000, reasonCode=120]"
            },
            {
              "raw": "2020-06-11 18:09:23,540 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-25) CybersourcePaymentServiceImpl -  update transaction 940936873"
            },
            {
              "raw": "2020-06-11 18:09:23,541 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorCaptureServiceImpl] (default task-25) CybersourceCaptureServiceImpl - CaptureEntity [id=null, transactionId=940936873, captureAmt=2.00, partialCapture=false, txnAmt=2.00, respCode=02, respMsg=EN, accNo=411111XXXXXX1111, merchantId=NTT, rrn=5918701618976797804011, captureMode=AUTO, ]"
            },
            {
              "raw": "2020-06-11 18:09:23,553 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-25) 940936873: Capture request from NTT to cybs with HKD[purchaseTotals_currency=HKD, merchantReferenceCode=940936873, ccCaptureService_run=true, ccCaptureService_authRequestID=5918701618976797804011, purchaseTotals_grandTotalAmount=2.00]"
            },
            {
              "raw": "2020-06-11 18:09:23,962 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-25) 940936873: Capture response from cybs to NTT with HKD[decision=REJECT, merchantReferenceCode=940936873, requestID=5918701624106461204012, reasonCode=235, ccCaptureReply_reasonCode=235]"
            },
            {
              "raw": "2020-06-11 18:09:23,962 INFO  [com.nttdata.hk.processor.cybersource.serivce.Impl.CybersourceCaptureServiceImpl] (default task-25) update captureEntity CaptureEntity [id=97414, transactionId=940936873, captureAmt=2.00, partialCapture=false, txnAmt=2.00, respCode=235, respMsg=FL, accNo=411111XXXXXX1111, merchantId=NTT, rrn=5918701624106461204012, captureMode=AUTO, createdAt=2020-06-11 18:09:23.541, updatedAt=2020-06-11 18:09:23.541]"
            },
            {
              "raw": "2020-06-11 18:09:23,998 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-25) #test39 - 940936873 Cvv removal : OK"
            },
            {
              "raw": "2020-06-11 18:09:23,998 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-25) Update remove cvv log table - nttrefid: 940936873"
            },
            {
              "raw": "2020-06-11 18:09:24,017 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-25) 940936873: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=200, txncurr=HKD, txnid=test39, nttrefid=940936873, respcode=01, respdesc=Transaction Capture Failed, proc_code=235, date=2020-06-11 18:09:22, signature=6ab1a471e7ad4a02e4e62b1c4168c872b9ad05002e8776d31b7f89330af2b0f39ef6edb9dd4d20cd97c5ed0f3b31cd3fa07ece217c836526d239ac8e0ca0ef9a, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, errorCode=PE3011, errorDesc=Invalid capture amount requested]"
            },
            {
              "raw": "2020-06-11 18:09:24,021 INFO  [com.nttdata.hk.business.utils.CommonUtil] (common_util_thread5) Send slack message We have encountered PE3011 PE3011 for a transaction initiated by NTT with nttrefid 940936873, which the processor is cybs with error code 235. Please check the server logs in details if necessary"
            },
            {
              "raw": "2020-06-11 18:09:24,022 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread9) Callback Json: {\"amt\":\"200\",\"txncurr\":\"HKD\",\"txnid\":\"test39\",\"nttrefid\":\"940936873\",\"respcode\":\"01\",\"respdesc\":\"Transaction Capture Failed\",\"proc_code\":\"235\",\"date\":\"2020-06-11 18:09:22\",\"signature\":\"6ab1a471e7ad4a02e4e62b1c4168c872b9ad05002e8776d31b7f89330af2b0f39ef6edb9dd4d20cd97c5ed0f3b31cd3fa07ece217c836526d239ac8e0ca0ef9a\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"errorCode\":\"PE3011\",\"errorDesc\":\"Invalid capture amount requested\"}"
            },
            {
              "raw": "2020-06-11 18:09:36,453 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-28) 940936873: Refund request from NTT_AUTO to NTT with 9615735770@210.3.198.58:NttRequest [refundrefnum=9615735770, login=NTT, pass=XXX, nttrefid=940936873, amt=100, signature=975ce0139ea21f0960bbc9f660a3507b7cd0ac501ee01300cc930aa5291c42c6b32ac02ec3a49f91af58d6b2309b9aad590567aa4bd1bde2ad54eab60faaa7e1, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 18:09:36,495 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-28) 940936873: Refund response from NTT to NTT_AUTO with 9615735770@210.3.198.58:NttResponse [respcode=01, respdesc=Nonvoidable transaction status - failed transaction, signature=c5db6bd6c735ffb3a41aa7708af6d78939a03f3599d18558934a00c0d76457bad1582fc0b8ead0e37f554726d7f97b8a575a8cfd3590c095879c1865ecd0b539, isEnableRetry=null, errorCode=NE4022, errorDesc=Nonvoidable transaction status - failed transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4905",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-transaction_logtable",
      "frontend_cybsDB-capturetable",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "5nqO8sxAlrruZVZ5PJq5uRALHe9uhoHm2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "Y",
      "manualCapture": "Y",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "02",
        "respdesc": "Redirect To 3D Secure Page",
        "proc_code": "475",
        "redirect_url": true,
        "date": "2020-06-11 18:17:59",
        "signature": true,
        "login": "NTT_AUTO",
        "maskcardnumber": "411111XXXXXX1111",
        "authenticationStatus": "Y",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code"
      ]
    },
    "refund": {
      "refundMode": "VOID",
      "amt": "100",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Nonvoidable transaction status - pending transaction",
        "signature": true,
        "errorCode": "NE4021",
        "errorDesc": "Nonvoidable transaction status - pending transaction"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_logtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "booking_id",
              "amount",
              "response_code",
              "merchantid",
              "user_data_22",
              "txn_type",
              "user_data_45",
              "currency",
              "txn_status",
              "auth_code",
              "user_data_25",
              "channel_type",
              "stage",
              "user_data_3",
              "user_data_16",
              "user_data_43"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "capturetable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "capture",
            "columnNames": [
              "capture_amt",
              "currency",
              "pending_amt",
              "resp_code",
              "resp_msg",
              "capture_mode",
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "card_expirationMonth": "12",
              "raw": "2020-06-11 18:17:59,778 INFO  [com.nttdata.hk.secureManager.service.Impl.SecureCybersourceServiceImpl] (default task-23) 940937095: AuthEnroll request from NTT to cybs with HKD[payerAuthEnrollService_run=true, purchaseTotals_currency=HKD, card_expirationMonth=12, merchantReferenceCode=940937095, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-11 18:18:01,144 INFO  [com.nttdata.hk.secureManager.service.Impl.SecureCybersourceServiceImpl] (default task-23) 940937095: AuthEnroll response from cybs to NTT with HKD[payerAuthEnrollReply_proxyPAN=3739974, payerAuthEnrollReply_reasonCode=475, decision=REJECT, payerAuthEnrollReply_paReq=eNpVUstuwjAQvPsrItQzjkMgDVosQVHLQ6WhDZXg5jpbiNS8nITA39cO0IcP1s6udz0zNoQHhTh9Q1kr5PCMZSn2aMXRqHOSx2axKLwMX4JivZXB59rucAjGr1hwOKIq4yzlrGt3HaA3SPQIJQ8irTgIWUzmK86cntsfePdArwkCCar5lPdc5jqO69iXBfSSJpCKBPkqDK2pqIQ1y9K9tdQb0LZAQGZ1WqmzHuACvQECtfrih6rKh5Q2TdOV5w9NKquVxK7MEqCmToD+EgxqE5Va9ymOOD6tnMjOlzKMjruNv5bvj7stmySbcDwCak4QiESF3LE15QFjFrOHzBv2faBtnoBIDBk+W95pW7SgKyaQm5vGF8RM5W9CC6qVwlTeFN0QATzlWYr6jLb4J9Yafpk/zIzRsjJ+ej3f91zjc4vb9lhb49js0h+3PlHTQ6/vSK9PrqN/X+Ebhh+suA==, merchantReferenceCode=940937095, payerAuthEnrollReply_proofXML=<AuthProof><Time>2020 Jun 11 10:17:59</Time><DSUrl>https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/vereq.jsp?acqid=StandardCATestCases</DSUrl><VEReqProof><Message id=\"xcvwJJq7oeOPqQYcPfQ0\"><VEReq><version>1.0.2</version><pan>XXXXXXXXXXXX1111</pan><Merchant><acqBIN>12345678</acqBIN><merID>341422420000000</merID><password></password></Merchant><Browser><deviceCategory>0</deviceCategory></Browser></VEReq></Message></VEReqProof><VEResProof><Message id=\"xcvwJJq7oeOPqQYcPfQ0\"><VERes><version>1.0.2</version><CH><enrolled>Y</enrolled><acctID>3739974</acctID></CH><url>https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/pareq.jsp?vaa=b&amp;gold=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</url><protocol>ThreeDSecure</protocol></VERes></Message></VEResProof></AuthProof>, requestID=5918706794276852504009, payerAuthEnrollReply_acsURL=https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/pareq.jsp?vaa=b&gold=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, reasonCode=475, payerAuthEnrollReply_xid=eGN2d0pKcTdvZU9QcVFZY1BmUTA=]"
            },
            {
              "raw": "2020-06-11 18:18:01,183 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-23) 940937095: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test39, nttrefid=940937095, respcode=02, respdesc=Redirect To 3D Secure Page, proc_code=475, redirect_url=https://uat.ndhkpay.com/Ndhk_Api/threedsecure/redirecturl?s=ef0b2452d317dd017bf3a365938ef28d, date=2020-06-11 18:17:59, signature=120994c7c09f888ef1a156f8d3f3a5814a9d00ed95f194f961c7639f87985b67ec0e5b0e8128ef572615e7e2a80d2e8146ef8d91759c0931123ccbb628b52535, login=NTT, maskcardnumber=411111XXXXXX1111, isEnableRetry=null, authenticationStatus=Y, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-11 18:21:23,073 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940937095: Refund request from NTT_AUTO to NTT with 2899589650@210.3.198.58:NttRequest [refundrefnum=2899589650, login=NTT, pass=XXX, nttrefid=940937095, amt=100, signature=5fcf757078a0f8b9014a72ab0943bec448e1503b0bddb45026fdd678fa4921c093dca3cb8b2acc5a3a512f9757690b4cc6165e720922494e01dce36f97f9fe5b, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 18:21:23,097 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940937095: Refund response from NTT to NTT_AUTO with 2899589650@210.3.198.58:NttResponse [respcode=01, respdesc=Nonvoidable transaction status - pending transaction, signature=1e481d69d3a46bad5949ccdfe8773f17d9c1ba1455e214037f3feea346fb2c6ddf97b9a7f8d7fb49a72f1b3af4fa4deb23f0e852fa01a2e500f1439564952c70, isEnableRetry=null, errorCode=NE4021, errorDesc=Nonvoidable transaction status - pending transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4902",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "captureRequestV2-capture",
      "refundRequestV2-refund",
      "frontend_cybsDB-transaction_logtable",
      "frontend_cybsDB-capturetable",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE1",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "Y",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE1",
        "respcode": "00",
        "respdesc": "Transaction Authorization Succeeded",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "manualCapture": "Y",
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code"
      ]
    },
    "capture": {
      "amt": "50",
      "txnid": "",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "expectedResult": {
        "respcode": "00",
        "respdesc": "success",
        "amt": "50",
        "proc_code": "100"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code"
      ]
    },
    "refund": {
      "refundMode": "REFUND",
      "amt": "100",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Refund amount exceeded the captured amount",
        "signature": true,
        "errorCode": "NE3019",
        "errorDesc": "Refund amount exceeded the captured amount"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_logtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "booking_id",
              "amount",
              "response_code",
              "merchantid",
              "user_data_22",
              "txn_type",
              "user_data_45",
              "currency",
              "txn_status",
              "auth_code",
              "user_data_25",
              "channel_type",
              "stage",
              "user_data_3",
              "user_data_16",
              "user_data_43"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "amount": "1.0000",
              "response_code": "100",
              "auth_code": "831000",
              "booking_id": "Refund_NE1",
              "user_data_25": null,
              "user_data_16": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
              "stage": "Transaction Authorization Succeeded",
              "merchantid": "NTT_AUTO",
              "txn_type": "AUTH",
              "user_data_45": "AUTH",
              "user_data_3": "100",
              "currency": "HKD",
              "channel_type": "cybs",
              "txn_status": "OK"
            }
          ]
        }
      }
    },
    "capturetable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "capture",
            "columnNames": [
              "capture_amt",
              "currency",
              "pending_amt",
              "resp_code",
              "resp_msg",
              "capture_mode",
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "pending_amt": "0.5000",
              "capture_amt": "0.5000",
              "resp_code": "100",
              "capture_mode": "MANUAL",
              "currency": "HKD",
              "resp_msg": "OK"
            }
          ]
        }
      }
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-12 10:53:59,919 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-15) 940938478: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940938478, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-12 10:54:01,596 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-15) 940938478: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940938478, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5919304392876741603011, ccAuthReply_amount=1.00, requestID=5919304392876741603011, ccAuthReply_authorizedDateTime=2020-06-12T02:53:59Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-12 10:54:01,603 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-15) CybersourcePaymentServiceImpl -  update transaction 940938478"
            },
            {
              "raw": "2020-06-12 10:54:01,635 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-15) #test39 - 940938478 Cvv removal : OK"
            },
            {
              "raw": "2020-06-12 10:54:01,636 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-15) Update remove cvv log table - nttrefid: 940938478"
            },
            {
              "raw": "2020-06-12 10:54:02,585 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-15) 940938478: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test39, nttrefid=940938478, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-12 10:53:59, signature=120994c7c09f888ef1a156f8d3f3a5814a9d00ed95f194f961c7639f87985b67ec0e5b0e8128ef572615e7e2a80d2e8146ef8d91759c0931123ccbb628b52535, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-12 10:54:31,395 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-32) Capture request from NTT_AUTO to NTT with null@210.3.198.58:NttRequest [login=NTT, pass=XXX, nttrefid=940938478, amt={amt}, signature=990e2745e66c12eebfcc9908fc08027911136edf2e7b3f450228fdf8afeed9a1cd06d38d33b71c962c19391d69e4cf16bb4d51e1f814baac39eea3e60eed79bb, callbackUrl=https://webhook.site/cf1a88fe-6ebe-4430-855c-899cf3149d3f, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 10:54:31,413 INFO  [com.nttdata.hk.api.controller.CaptureController] (default task-32) Capture: 940938478 response from NTT to NTT_AUTO with null@210.3.198.58:NttCaptureResponse [result=Invalid parameter - amt, errorCode=NE1023, errorDesc=Invalid parameter - amt]"
            },
            {
              "raw": "2020-06-12 10:55:07,422 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-18) CaptureV2 request from NTT_AUTO to NTT with null@210.3.198.58:NttRequest [login=NTT, pass=XXX, nttrefid=940938478, amt={amt}, signature=990e2745e66c12eebfcc9908fc08027911136edf2e7b3f450228fdf8afeed9a1cd06d38d33b71c962c19391d69e4cf16bb4d51e1f814baac39eea3e60eed79bb, callbackUrl=https://webhook.site/cf1a88fe-6ebe-4430-855c-899cf3149d3f, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 10:55:17,539 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-19) CaptureV2 request from NTT_AUTO to NTT with null@210.3.198.58:NttRequest [login=NTT, pass=XXX, nttrefid=940938478, amt=50, signature=990e2745e66c12eebfcc9908fc08027911136edf2e7b3f450228fdf8afeed9a1cd06d38d33b71c962c19391d69e4cf16bb4d51e1f814baac39eea3e60eed79bb, callbackUrl=https://webhook.site/cf1a88fe-6ebe-4430-855c-899cf3149d3f, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 10:55:17,580 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-19) 940938478: Capture request from NTT to cybs with HKD[purchaseTotals_currency=HKD, merchantReferenceCode=940938478, ccCaptureService_run=true, ccCaptureService_authRequestID=5919304392876741603011, purchaseTotals_grandTotalAmount=0.50]"
            },
            {
              "raw": "2020-06-12 10:55:19,058 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-19) 940938478: Capture response from cybs to NTT with HKD[purchaseTotals_currency=HKD, decision=ACCEPT, requestID=5919305169146067203012, merchantReferenceCode=940938478, ccCaptureReply_reconciliationID=5919304392876741603011, reasonCode=100, ccCaptureReply_requestDateTime=2020-06-12T02:55:17Z, ccCaptureReply_reasonCode=100, ccCaptureReply_amount=0.50]"
            },
            {
              "raw": "2020-06-12 10:55:19,059 INFO  [com.nttdata.hk.processor.cybersource.serivce.Impl.CybersourceCaptureServiceImpl] (default task-19) update captureEntity CaptureEntity [id=98057, transactionId=940938478, captureAmt=0.50, partialCapture=true, txnAmt=1.00, respCode=00, respMsg=OK, accNo=411111XXXXXX1111, merchantId=NTT, rrn=5919305169146067203012, captureMode=MANUAL, createdAt=2020-06-12 10:55:17.565, updatedAt=2020-06-12 10:55:17.565]"
            },
            {
              "raw": "2020-06-12 10:55:19,072 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-19) 940938478: CaptureV2 response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=50, txncurr=HKD, txnid=test39, nttrefid=940938478, respcode=00, respdesc=success, proc_code=100, signature=e69cc4082ec54b843e3ddcd902f19e7a71f2775d1ea6283bdc59eeef974a46eab999ff3a755b61f303424bdcebfc6c30e59a3bc3b31599ac1119edc98603774d, login=NTT, isEnableRetry=null, captureId=98057, ]"
            },
            {
              "raw": "2020-06-12 10:55:53,727 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-20) 940938478: Refund request from NTT_AUTO to NTT with 1832631050@210.3.198.58:NttRequest [refundrefnum=1832631050, login=NTT, pass=XXX, nttrefid=940938478, amt=100, signature=0a04b3a382db9933537c77fb77e5e0d36c6724dd63f217e528934ee7b8b5a16fd2df245ddee1054c8aa5fd45a0f4050c983fd1b904ce6a88cd8a6213d7ad6d82, isEnableRetry=false, refundMode=REFUND, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 10:55:53,760 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-20) 940938478: Refund response from NTT to NTT_AUTO with 1832631050@210.3.198.58:NttResponse [respcode=01, respdesc=Refund amount exceeded the captured amount, signature=d9191329c29d08c0d957576e1e2e7b9679611841bffe8b563ffc2aaed1fa2c6fa0583325574d858d600a9ae61b93dd5d451ef73958cc847eff063cfa901df43e, isEnableRetry=null, errorCode=NE3019, errorDesc=Refund amount exceeded the captured amount]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4901",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-transaction_logtable",
      "frontend_cybsDB-capturetable",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "Y",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "test39",
        "nttrefid": "940938478",
        "respcode": "00",
        "respdesc": "Transaction Authorization Succeeded",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "manualCapture": "Y",
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code"
      ]
    },
    "refund": {
      "refundMode": "REFUND",
      "amt": "100",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Nonrefundable transaction status - uncaptured transaction",
        "signature": true,
        "errorCode": "NE4017",
        "errorDesc": "Nonrefundable transaction status - uncaptured transaction"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_logtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "booking_id",
              "amount",
              "response_code",
              "merchantid",
              "user_data_22",
              "txn_type",
              "user_data_45",
              "currency",
              "txn_status",
              "auth_code",
              "user_data_25",
              "channel_type",
              "stage",
              "user_data_3",
              "user_data_16",
              "user_data_43"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "amount": "1.0000",
              "response_code": "100",
              "auth_code": "831000",
              "booking_id": "Refund_NE",
              "user_data_25": null,
              "user_data_16": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
              "stage": "Transaction Authorization Succeeded",
              "merchantid": "NTT_AUTO",
              "txn_type": "AUTH",
              "user_data_45": "AUTH",
              "user_data_3": "100",
              "currency": "HKD",
              "channel_type": "cybs",
              "txn_status": "OK"
            }
          ]
        }
      }
    },
    "capturetable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "capture",
            "columnNames": [
              "capture_amt",
              "currency",
              "pending_amt",
              "resp_code",
              "resp_msg",
              "capture_mode",
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-12 15:22:05,180 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-6) 940939414: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940939414, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-12 15:22:06,829 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-6) 940939414: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940939414, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5919465244876350603011, ccAuthReply_amount=1.00, requestID=5919465244876350603011, ccAuthReply_authorizedDateTime=2020-06-12T07:22:04Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-12 15:22:06,836 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-6) CybersourcePaymentServiceImpl -  update transaction 940939414"
            },
            {
              "raw": "2020-06-12 15:22:06,860 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-6) #test391 - 940939414 Cvv removal : OK"
            },
            {
              "raw": "2020-06-12 15:22:06,860 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-6) Update remove cvv log table - nttrefid: 940939414"
            },
            {
              "raw": "2020-06-12 15:22:07,784 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-6) 940939414: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940939414, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-12 15:22:05, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-12 15:22:22,034 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-24) 940939414: Refund request from NTT_AUTO to NTT with 6535920723@210.3.198.58:NttRequest [refundrefnum=6535920723, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=10eb9696ac82b74f69af8c11307232f028727193c74eab4344ff5f499af5f7dd53e90b78c7a537c4c9bdbb5b25ba99498424dd9cca5c2365b4af9002be41232c, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:22:22,060 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-24) 940939414: Refund response from NTT to NTT_AUTO with 6535920723@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid API credentials, signature=0fbf15d502c354e60f5f65792ef37b1c33d701366dbdd94d97f600d4d8025ff8c1a31f1148646114565267afc5bbbd7409679e696a8e027ca15f5f8bb870d775, isEnableRetry=null, errorCode=NE0100, errorDesc=Invalid API credentials]"
            },
            {
              "raw": "2020-06-12 15:22:42,730 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940939414: Refund request from NTT_AUTO to NTT with 9895200520@210.3.198.58:NttRequest [refundrefnum=9895200520, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=0bd9b152c7fae77383c09bdea10a0f590db104f6330af34bedc7a8b310accc3694d24aa6bbd3b77d9eed293a61996e43ab76052cab5ae1785bd38eb3a65b3d4f, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:22:42,749 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940939414: Refund response from NTT to NTT_AUTO with 9895200520@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid API credentials, signature=718714ccc3ca7656085510e582f4df44e187f6a16320c40dde6bd65197ab282253e8c2012f450c2100499e216455a5e85fad54af817dc7e5b9cc97f83dfc0d86, isEnableRetry=null, errorCode=NE0100, errorDesc=Invalid API credentials]"
            },
            {
              "raw": "2020-06-12 15:22:58,053 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-5) 940939414: Refund request from NTT_AUTO to NTT with 1606102930@210.3.198.58:NttRequest [refundrefnum=1606102930, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=ee12ad7b8ba3d2611c5a648ad7712a731804cb0eddc4bff624076ba96f7a66979e18151581f36c40e4490ac1ce1ed439d6dc7073be565f9381232cc503d05b8f, isEnableRetry=false, refundMode=REFUND, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:22:58,077 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-5) 940939414: Refund response from NTT to NTT_AUTO with 1606102930@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid API credentials, signature=14e40f9deff6136d98e616a4adaee98cf7fd6562f20c26fe36e4d7d84f77f756bd6f111d7db2fdc0a251da344ef3a87e21352df7fc3686e33bc4beb97cd0eeac, isEnableRetry=null, errorCode=NE0100, errorDesc=Invalid API credentials]"
            },
            {
              "raw": "2020-06-12 15:23:14,747 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-17) 940939414: Refund request from NTT_AUTO to NTT with 6595911377@210.3.198.58:NttRequest [refundrefnum=6595911377, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=93bcb56fe3709ddeed562257b0ac3c85dce04ff5e36ace5d504517e8da106c873f55aa8bc9e43ad4da8e3c52c0393d290961397ef05ba093f901d9ce724c74ca, isEnableRetry=false, refundMode=REFUND, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:23:14,780 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-17) 940939414: Refund response from NTT to NTT_AUTO with 6595911377@210.3.198.58:NttResponse [respcode=01, respdesc=Nonrefundable transaction status - uncaptured transaction, signature=ee24b4315a0f01b5e341fae6659b58d9970b3ca294644c4d99d79a3f1ec0f85875462b1058ea4752659b75efd327bfdd731a235b7a6b3f95dcf7d0b520209cee, isEnableRetry=null, errorCode=NE4017, errorDesc=Nonrefundable transaction status - uncaptured transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "4900",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "refundRequestV2-refund1",
      "frontend_cybsDB-transaction_logtable",
      "frontend_cybsDB-capturetable",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "manualCapture": "Y",
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code"
      ]
    },
    "refund": {
      "refundMode": "REFUND",
      "amt": "100",
      "expectedResult": {
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "proc_code"
      ]
    },
    "refund1": {
      "refundMode": "REFUND",
      "amt": "100",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Refund amount exceeded the captured amount",
        "errorCode": "NE3019",
        "errorDesc": "Refund amount exceeded the captured amount"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_logtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "booking_id",
              "amount",
              "response_code",
              "merchantid",
              "user_data_22",
              "txn_type",
              "user_data_45",
              "currency",
              "txn_status",
              "auth_code",
              "user_data_25",
              "channel_type",
              "stage",
              "user_data_3",
              "user_data_16",
              "user_data_43"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "amount": "1.0000",
              "response_code": "100",
              "auth_code": "831000",
              "booking_id": "Refund_NE",
              "user_data_25": "Fully_Refunded",
              "user_data_16": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
              "stage": "Transaction Completed",
              "merchantid": "NTT_AUTO",
              "txn_type": "DIRECT",
              "user_data_45": "PURCHASE",
              "user_data_3": "100",
              "currency": "HKD",
              "channel_type": "cybs",
              "txn_status": "OK"
            }
          ]
        }
      }
    },
    "capturetable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "capture",
            "columnNames": [
              "capture_amt",
              "currency",
              "pending_amt",
              "resp_code",
              "resp_msg",
              "capture_mode",
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-12 15:22:05,180 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-6) 940939414: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940939414, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-12 15:22:06,829 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-6) 940939414: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940939414, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5919465244876350603011, ccAuthReply_amount=1.00, requestID=5919465244876350603011, ccAuthReply_authorizedDateTime=2020-06-12T07:22:04Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-12 15:22:06,836 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-6) CybersourcePaymentServiceImpl -  update transaction 940939414"
            },
            {
              "raw": "2020-06-12 15:22:06,860 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-6) #test391 - 940939414 Cvv removal : OK"
            },
            {
              "raw": "2020-06-12 15:22:06,860 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-6) Update remove cvv log table - nttrefid: 940939414"
            },
            {
              "raw": "2020-06-12 15:22:07,784 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-6) 940939414: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940939414, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-12 15:22:05, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-12 15:22:22,034 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-24) 940939414: Refund request from NTT_AUTO to NTT with 6535920723@210.3.198.58:NttRequest [refundrefnum=6535920723, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=10eb9696ac82b74f69af8c11307232f028727193c74eab4344ff5f499af5f7dd53e90b78c7a537c4c9bdbb5b25ba99498424dd9cca5c2365b4af9002be41232c, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:22:22,060 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-24) 940939414: Refund response from NTT to NTT_AUTO with 6535920723@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid API credentials, signature=0fbf15d502c354e60f5f65792ef37b1c33d701366dbdd94d97f600d4d8025ff8c1a31f1148646114565267afc5bbbd7409679e696a8e027ca15f5f8bb870d775, isEnableRetry=null, errorCode=NE0100, errorDesc=Invalid API credentials]"
            },
            {
              "raw": "2020-06-12 15:22:42,730 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940939414: Refund request from NTT_AUTO to NTT with 9895200520@210.3.198.58:NttRequest [refundrefnum=9895200520, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=0bd9b152c7fae77383c09bdea10a0f590db104f6330af34bedc7a8b310accc3694d24aa6bbd3b77d9eed293a61996e43ab76052cab5ae1785bd38eb3a65b3d4f, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:22:42,749 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940939414: Refund response from NTT to NTT_AUTO with 9895200520@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid API credentials, signature=718714ccc3ca7656085510e582f4df44e187f6a16320c40dde6bd65197ab282253e8c2012f450c2100499e216455a5e85fad54af817dc7e5b9cc97f83dfc0d86, isEnableRetry=null, errorCode=NE0100, errorDesc=Invalid API credentials]"
            },
            {
              "raw": "2020-06-12 15:22:58,053 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-5) 940939414: Refund request from NTT_AUTO to NTT with 1606102930@210.3.198.58:NttRequest [refundrefnum=1606102930, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=ee12ad7b8ba3d2611c5a648ad7712a731804cb0eddc4bff624076ba96f7a66979e18151581f36c40e4490ac1ce1ed439d6dc7073be565f9381232cc503d05b8f, isEnableRetry=false, refundMode=REFUND, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:22:58,077 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-5) 940939414: Refund response from NTT to NTT_AUTO with 1606102930@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid API credentials, signature=14e40f9deff6136d98e616a4adaee98cf7fd6562f20c26fe36e4d7d84f77f756bd6f111d7db2fdc0a251da344ef3a87e21352df7fc3686e33bc4beb97cd0eeac, isEnableRetry=null, errorCode=NE0100, errorDesc=Invalid API credentials]"
            },
            {
              "raw": "2020-06-12 15:23:14,747 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-17) 940939414: Refund request from NTT_AUTO to NTT with 6595911377@210.3.198.58:NttRequest [refundrefnum=6595911377, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=93bcb56fe3709ddeed562257b0ac3c85dce04ff5e36ace5d504517e8da106c873f55aa8bc9e43ad4da8e3c52c0393d290961397ef05ba093f901d9ce724c74ca, isEnableRetry=false, refundMode=REFUND, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:23:14,780 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-17) 940939414: Refund response from NTT to NTT_AUTO with 6595911377@210.3.198.58:NttResponse [respcode=01, respdesc=Nonrefundable transaction status - uncaptured transaction, signature=ee24b4315a0f01b5e341fae6659b58d9970b3ca294644c4d99d79a3f1ec0f85875462b1058ea4752659b75efd327bfdd731a235b7a6b3f95dcf7d0b520209cee, isEnableRetry=null, errorCode=NE4017, errorDesc=Nonrefundable transaction status - uncaptured transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4899",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-void",
      "refundRequestV2-void1",
      "frontend_cybsDB-transaction_logtable",
      "frontend_cybsDB-capturetable",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "Y",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "Transaction Authorization Succeeded",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "manualCapture": "Y",
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code"
      ]
    },
    "void": {
      "refundMode": "VOID",
      "amt": "100",
      "expectedResult": {
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "proc_code"
      ]
    },
    "void1": {
      "refundMode": "VOID",
      "amt": "100",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Nonvoidable transaction status - voided transaction",
        "errorCode": "NE4023",
        "errorDesc": "Nonvoidable transaction status - voided transaction"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_logtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "booking_id",
              "amount",
              "response_code",
              "merchantid",
              "user_data_22",
              "txn_type",
              "user_data_45",
              "currency",
              "txn_status",
              "auth_code",
              "user_data_25",
              "channel_type",
              "stage",
              "user_data_3",
              "user_data_16",
              "user_data_43"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "amount": "1.0000",
              "response_code": "100",
              "auth_code": "831000",
              "booking_id": "Refund_NE",
              "user_data_25": "Fully_Refunded",
              "user_data_16": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
              "stage": "Transaction Authorization Succeeded",
              "merchantid": "NTT_AUTO",
              "txn_type": "AUTH",
              "user_data_45": "AUTH",
              "user_data_3": "100",
              "currency": "HKD",
              "channel_type": "cybs",
              "txn_status": "OK"
            }
          ]
        }
      }
    },
    "capturetable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "capture",
            "columnNames": [
              "capture_amt",
              "currency",
              "pending_amt",
              "resp_code",
              "resp_msg",
              "capture_mode",
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-12 15:22:05,180 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-6) 940939414: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940939414, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-12 15:22:06,829 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-6) 940939414: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940939414, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5919465244876350603011, ccAuthReply_amount=1.00, requestID=5919465244876350603011, ccAuthReply_authorizedDateTime=2020-06-12T07:22:04Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-12 15:22:06,836 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-6) CybersourcePaymentServiceImpl -  update transaction 940939414"
            },
            {
              "raw": "2020-06-12 15:22:06,860 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-6) #test391 - 940939414 Cvv removal : OK"
            },
            {
              "raw": "2020-06-12 15:22:06,860 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-6) Update remove cvv log table - nttrefid: 940939414"
            },
            {
              "raw": "2020-06-12 15:22:07,784 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-6) 940939414: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940939414, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-12 15:22:05, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-12 15:22:22,034 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-24) 940939414: Refund request from NTT_AUTO to NTT with 6535920723@210.3.198.58:NttRequest [refundrefnum=6535920723, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=10eb9696ac82b74f69af8c11307232f028727193c74eab4344ff5f499af5f7dd53e90b78c7a537c4c9bdbb5b25ba99498424dd9cca5c2365b4af9002be41232c, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:22:22,060 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-24) 940939414: Refund response from NTT to NTT_AUTO with 6535920723@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid API credentials, signature=0fbf15d502c354e60f5f65792ef37b1c33d701366dbdd94d97f600d4d8025ff8c1a31f1148646114565267afc5bbbd7409679e696a8e027ca15f5f8bb870d775, isEnableRetry=null, errorCode=NE0100, errorDesc=Invalid API credentials]"
            },
            {
              "raw": "2020-06-12 15:22:42,730 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940939414: Refund request from NTT_AUTO to NTT with 9895200520@210.3.198.58:NttRequest [refundrefnum=9895200520, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=0bd9b152c7fae77383c09bdea10a0f590db104f6330af34bedc7a8b310accc3694d24aa6bbd3b77d9eed293a61996e43ab76052cab5ae1785bd38eb3a65b3d4f, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:22:42,749 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940939414: Refund response from NTT to NTT_AUTO with 9895200520@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid API credentials, signature=718714ccc3ca7656085510e582f4df44e187f6a16320c40dde6bd65197ab282253e8c2012f450c2100499e216455a5e85fad54af817dc7e5b9cc97f83dfc0d86, isEnableRetry=null, errorCode=NE0100, errorDesc=Invalid API credentials]"
            },
            {
              "raw": "2020-06-12 15:22:58,053 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-5) 940939414: Refund request from NTT_AUTO to NTT with 1606102930@210.3.198.58:NttRequest [refundrefnum=1606102930, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=ee12ad7b8ba3d2611c5a648ad7712a731804cb0eddc4bff624076ba96f7a66979e18151581f36c40e4490ac1ce1ed439d6dc7073be565f9381232cc503d05b8f, isEnableRetry=false, refundMode=REFUND, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:22:58,077 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-5) 940939414: Refund response from NTT to NTT_AUTO with 1606102930@210.3.198.58:NttResponse [respcode=01, respdesc=Invalid API credentials, signature=14e40f9deff6136d98e616a4adaee98cf7fd6562f20c26fe36e4d7d84f77f756bd6f111d7db2fdc0a251da344ef3a87e21352df7fc3686e33bc4beb97cd0eeac, isEnableRetry=null, errorCode=NE0100, errorDesc=Invalid API credentials]"
            },
            {
              "raw": "2020-06-12 15:23:14,747 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-17) 940939414: Refund request from NTT_AUTO to NTT with 6595911377@210.3.198.58:NttRequest [refundrefnum=6595911377, login=NTT, pass=XXX, nttrefid=940939414, amt=100, signature=93bcb56fe3709ddeed562257b0ac3c85dce04ff5e36ace5d504517e8da106c873f55aa8bc9e43ad4da8e3c52c0393d290961397ef05ba093f901d9ce724c74ca, isEnableRetry=false, refundMode=REFUND, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-12 15:23:14,780 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-17) 940939414: Refund response from NTT to NTT_AUTO with 6595911377@210.3.198.58:NttResponse [respcode=01, respdesc=Nonrefundable transaction status - uncaptured transaction, signature=ee24b4315a0f01b5e341fae6659b58d9970b3ca294644c4d99d79a3f1ec0f85875462b1058ea4752659b75efd327bfdd731a235b7a6b3f95dcf7d0b520209cee, isEnableRetry=null, errorCode=NE4017, errorDesc=Nonrefundable transaction status - uncaptured transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4894",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-transaction_logtable",
      "frontend_cybsDB-capturetable",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "200",
      "txnid": "Refund_NE",
      "txncurr": "MMK",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "amt": "200",
        "errorCode": "PE1016",
        "errorDesc": "Payment Processor General System Error",
        "respcode": "01",
        "respdesc": "fail",
        "proc_code": "150",
        "channelType": "cybs"
      },
      "needAssert": [
        "amt",
        "errorCode",
        "errorDesc",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "refundMode": "REFUND",
      "amt": "200",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Nonrefundable transaction status - failed transaction",
        "signature": true,
        "errorCode": "NE4016",
        "errorDesc": "Nonrefundable transaction status - failed transaction"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_logtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "booking_id",
              "amount",
              "response_code",
              "merchantid",
              "user_data_22",
              "txn_type",
              "user_data_45",
              "currency",
              "txn_status",
              "auth_code",
              "user_data_25",
              "channel_type",
              "stage",
              "user_data_3",
              "user_data_16",
              "user_data_43"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "amount": "2.0000",
              "response_code": "150",
              "auth_code": null,
              "booking_id": "Refund_NE",
              "user_data_25": null,
              "user_data_16": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
              "stage": "Transaction Failed",
              "merchantid": "NTT_AUTO",
              "txn_type": "DIRECT",
              "user_data_45": "PURCHASE",
              "user_data_3": "200",
              "currency": "MMK",
              "channel_type": "cybs",
              "txn_status": "FL"
            }
          ]
        }
      }
    },
    "capturetable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "capture",
            "columnNames": [
              "capture_amt",
              "currency",
              "pending_amt",
              "resp_code",
              "resp_msg",
              "capture_mode",
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-11 18:09:22,299 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-25) 940936873: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940936873, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=2.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-11 18:09:23,534 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-25) 940936873: Authorization response from cybs to NTT with HKD[ccAuthReply_reconciliationID=5918701618976797804011, purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=2, ccAuthReply_reasonCode=120, decision=ACCEPT, ccAuthReply_amount=0.00, merchantReferenceCode=940936873, requestID=5918701618976797804011, ccAuthReply_authorizedDateTime=2020-06-11T10:09:22Z, ccAuthReply_authorizationCode=831000, reasonCode=120]"
            },
            {
              "raw": "2020-06-11 18:09:23,540 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-25) CybersourcePaymentServiceImpl -  update transaction 940936873"
            },
            {
              "raw": "2020-06-11 18:09:23,541 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorCaptureServiceImpl] (default task-25) CybersourceCaptureServiceImpl - CaptureEntity [id=null, transactionId=940936873, captureAmt=2.00, partialCapture=false, txnAmt=2.00, respCode=02, respMsg=EN, accNo=411111XXXXXX1111, merchantId=NTT, rrn=5918701618976797804011, captureMode=AUTO, ]"
            },
            {
              "raw": "2020-06-11 18:09:23,553 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-25) 940936873: Capture request from NTT to cybs with HKD[purchaseTotals_currency=HKD, merchantReferenceCode=940936873, ccCaptureService_run=true, ccCaptureService_authRequestID=5918701618976797804011, purchaseTotals_grandTotalAmount=2.00]"
            },
            {
              "raw": "2020-06-11 18:09:23,962 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-25) 940936873: Capture response from cybs to NTT with HKD[decision=REJECT, merchantReferenceCode=940936873, requestID=5918701624106461204012, reasonCode=235, ccCaptureReply_reasonCode=235]"
            },
            {
              "raw": "2020-06-11 18:09:23,962 INFO  [com.nttdata.hk.processor.cybersource.serivce.Impl.CybersourceCaptureServiceImpl] (default task-25) update captureEntity CaptureEntity [id=97414, transactionId=940936873, captureAmt=2.00, partialCapture=false, txnAmt=2.00, respCode=235, respMsg=FL, accNo=411111XXXXXX1111, merchantId=NTT, rrn=5918701624106461204012, captureMode=AUTO, createdAt=2020-06-11 18:09:23.541, updatedAt=2020-06-11 18:09:23.541]"
            },
            {
              "raw": "2020-06-11 18:09:23,998 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-25) #test39 - 940936873 Cvv removal : OK"
            },
            {
              "raw": "2020-06-11 18:09:23,998 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-25) Update remove cvv log table - nttrefid: 940936873"
            },
            {
              "raw": "2020-06-11 18:09:24,017 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-25) 940936873: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=200, txncurr=HKD, txnid=test39, nttrefid=940936873, respcode=01, respdesc=Transaction Capture Failed, proc_code=235, date=2020-06-11 18:09:22, signature=6ab1a471e7ad4a02e4e62b1c4168c872b9ad05002e8776d31b7f89330af2b0f39ef6edb9dd4d20cd97c5ed0f3b31cd3fa07ece217c836526d239ac8e0ca0ef9a, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, errorCode=PE3011, errorDesc=Invalid capture amount requested]"
            },
            {
              "raw": "2020-06-11 18:09:24,021 INFO  [com.nttdata.hk.business.utils.CommonUtil] (common_util_thread5) Send slack message We have encountered PE3011 PE3011 for a transaction initiated by NTT with nttrefid 940936873, which the processor is cybs with error code 235. Please check the server logs in details if necessary"
            },
            {
              "raw": "2020-06-11 18:09:24,022 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread9) Callback Json: {\"amt\":\"200\",\"txncurr\":\"HKD\",\"txnid\":\"test39\",\"nttrefid\":\"940936873\",\"respcode\":\"01\",\"respdesc\":\"Transaction Capture Failed\",\"proc_code\":\"235\",\"date\":\"2020-06-11 18:09:22\",\"signature\":\"6ab1a471e7ad4a02e4e62b1c4168c872b9ad05002e8776d31b7f89330af2b0f39ef6edb9dd4d20cd97c5ed0f3b31cd3fa07ece217c836526d239ac8e0ca0ef9a\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"errorCode\":\"PE3011\",\"errorDesc\":\"Invalid capture amount requested\"}"
            },
            {
              "raw": "2020-06-11 18:09:36,453 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-28) 940936873: Refund request from NTT_AUTO to NTT with 9615735770@210.3.198.58:NttRequest [refundrefnum=9615735770, login=NTT, pass=XXX, nttrefid=940936873, amt=100, signature=975ce0139ea21f0960bbc9f660a3507b7cd0ac501ee01300cc930aa5291c42c6b32ac02ec3a49f91af58d6b2309b9aad590567aa4bd1bde2ad54eab60faaa7e1, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 18:09:36,495 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-28) 940936873: Refund response from NTT to NTT_AUTO with 9615735770@210.3.198.58:NttResponse [respcode=01, respdesc=Nonvoidable transaction status - failed transaction, signature=c5db6bd6c735ffb3a41aa7708af6d78939a03f3599d18558934a00c0d76457bad1582fc0b8ead0e37f554726d7f97b8a575a8cfd3590c095879c1865ecd0b539, isEnableRetry=null, errorCode=NE4022, errorDesc=Nonvoidable transaction status - failed transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4893",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-transaction_logtable",
      "frontend_cybsDB-capturetable",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "5nqO8sxAlrruZVZ5PJq5uRALHe9uhoHm2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "Y",
      "manualCapture": "Y",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "02",
        "respdesc": "Redirect To 3D Secure Page",
        "proc_code": "475",
        "redirect_url": true,
        "date": "2020-06-11 18:17:59",
        "signature": true,
        "login": "NTT_AUTO",
        "maskcardnumber": "411111XXXXXX1111",
        "authenticationStatus": "Y",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code"
      ]
    },
    "refund": {
      "refundMode": "REFUND",
      "amt": "100",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Nonrefundable transaction status - pending transaction",
        "signature": true,
        "errorCode": "NE4015",
        "errorDesc": "Nonrefundable transaction status - pending transaction"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_logtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "booking_id",
              "amount",
              "response_code",
              "merchantid",
              "user_data_22",
              "txn_type",
              "user_data_45",
              "currency",
              "txn_status",
              "auth_code",
              "user_data_25",
              "channel_type",
              "stage",
              "user_data_3",
              "user_data_16",
              "user_data_43"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "capturetable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "capture",
            "columnNames": [
              "capture_amt",
              "currency",
              "pending_amt",
              "resp_code",
              "resp_msg",
              "capture_mode",
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "card_expirationMonth": "12",
              "raw": "2020-06-11 18:17:59,778 INFO  [com.nttdata.hk.secureManager.service.Impl.SecureCybersourceServiceImpl] (default task-23) 940937095: AuthEnroll request from NTT to cybs with HKD[payerAuthEnrollService_run=true, purchaseTotals_currency=HKD, card_expirationMonth=12, merchantReferenceCode=940937095, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-11 18:18:01,144 INFO  [com.nttdata.hk.secureManager.service.Impl.SecureCybersourceServiceImpl] (default task-23) 940937095: AuthEnroll response from cybs to NTT with HKD[payerAuthEnrollReply_proxyPAN=3739974, payerAuthEnrollReply_reasonCode=475, decision=REJECT, payerAuthEnrollReply_paReq=eNpVUstuwjAQvPsrItQzjkMgDVosQVHLQ6WhDZXg5jpbiNS8nITA39cO0IcP1s6udz0zNoQHhTh9Q1kr5PCMZSn2aMXRqHOSx2axKLwMX4JivZXB59rucAjGr1hwOKIq4yzlrGt3HaA3SPQIJQ8irTgIWUzmK86cntsfePdArwkCCar5lPdc5jqO69iXBfSSJpCKBPkqDK2pqIQ1y9K9tdQb0LZAQGZ1WqmzHuACvQECtfrih6rKh5Q2TdOV5w9NKquVxK7MEqCmToD+EgxqE5Va9ymOOD6tnMjOlzKMjruNv5bvj7stmySbcDwCak4QiESF3LE15QFjFrOHzBv2faBtnoBIDBk+W95pW7SgKyaQm5vGF8RM5W9CC6qVwlTeFN0QATzlWYr6jLb4J9Yafpk/zIzRsjJ+ej3f91zjc4vb9lhb49js0h+3PlHTQ6/vSK9PrqN/X+Ebhh+suA==, merchantReferenceCode=940937095, payerAuthEnrollReply_proofXML=<AuthProof><Time>2020 Jun 11 10:17:59</Time><DSUrl>https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/vereq.jsp?acqid=StandardCATestCases</DSUrl><VEReqProof><Message id=\"xcvwJJq7oeOPqQYcPfQ0\"><VEReq><version>1.0.2</version><pan>XXXXXXXXXXXX1111</pan><Merchant><acqBIN>12345678</acqBIN><merID>341422420000000</merID><password></password></Merchant><Browser><deviceCategory>0</deviceCategory></Browser></VEReq></Message></VEReqProof><VEResProof><Message id=\"xcvwJJq7oeOPqQYcPfQ0\"><VERes><version>1.0.2</version><CH><enrolled>Y</enrolled><acctID>3739974</acctID></CH><url>https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/pareq.jsp?vaa=b&amp;gold=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</url><protocol>ThreeDSecure</protocol></VERes></Message></VEResProof></AuthProof>, requestID=5918706794276852504009, payerAuthEnrollReply_acsURL=https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/pareq.jsp?vaa=b&gold=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, reasonCode=475, payerAuthEnrollReply_xid=eGN2d0pKcTdvZU9QcVFZY1BmUTA=]"
            },
            {
              "raw": "2020-06-11 18:18:01,183 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-23) 940937095: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test39, nttrefid=940937095, respcode=02, respdesc=Redirect To 3D Secure Page, proc_code=475, redirect_url=https://uat.ndhkpay.com/Ndhk_Api/threedsecure/redirecturl?s=ef0b2452d317dd017bf3a365938ef28d, date=2020-06-11 18:17:59, signature=120994c7c09f888ef1a156f8d3f3a5814a9d00ed95f194f961c7639f87985b67ec0e5b0e8128ef572615e7e2a80d2e8146ef8d91759c0931123ccbb628b52535, login=NTT, maskcardnumber=411111XXXXXX1111, isEnableRetry=null, authenticationStatus=Y, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-11 18:21:23,073 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940937095: Refund request from NTT_AUTO to NTT with 2899589650@210.3.198.58:NttRequest [refundrefnum=2899589650, login=NTT, pass=XXX, nttrefid=940937095, amt=100, signature=5fcf757078a0f8b9014a72ab0943bec448e1503b0bddb45026fdd678fa4921c093dca3cb8b2acc5a3a512f9757690b4cc6165e720922494e01dce36f97f9fe5b, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 18:21:23,097 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940937095: Refund response from NTT to NTT_AUTO with 2899589650@210.3.198.58:NttResponse [respcode=01, respdesc=Nonvoidable transaction status - pending transaction, signature=1e481d69d3a46bad5949ccdfe8773f17d9c1ba1455e214037f3feea346fb2c6ddf97b9a7f8d7fb49a72f1b3af4fa4deb23f0e852fa01a2e500f1439564952c70, isEnableRetry=null, errorCode=NE4021, errorDesc=Nonvoidable transaction status - pending transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4892",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "200",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "amt": "200",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "channelType": "cybs"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "refundMode": "INVALID",
      "amt": "100",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Invalid parameter - refundMode",
        "signature": true,
        "errorCode": "NE1079",
        "errorDesc": "Invalid parameter - refundMode"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "card_expirationMonth": "12",
              "raw": "2020-06-11 18:17:59,778 INFO  [com.nttdata.hk.secureManager.service.Impl.SecureCybersourceServiceImpl] (default task-23) 940937095: AuthEnroll request from NTT to cybs with HKD[payerAuthEnrollService_run=true, purchaseTotals_currency=HKD, card_expirationMonth=12, merchantReferenceCode=940937095, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-11 18:18:01,144 INFO  [com.nttdata.hk.secureManager.service.Impl.SecureCybersourceServiceImpl] (default task-23) 940937095: AuthEnroll response from cybs to NTT with HKD[payerAuthEnrollReply_proxyPAN=3739974, payerAuthEnrollReply_reasonCode=475, decision=REJECT, payerAuthEnrollReply_paReq=eNpVUstuwjAQvPsrItQzjkMgDVosQVHLQ6WhDZXg5jpbiNS8nITA39cO0IcP1s6udz0zNoQHhTh9Q1kr5PCMZSn2aMXRqHOSx2axKLwMX4JivZXB59rucAjGr1hwOKIq4yzlrGt3HaA3SPQIJQ8irTgIWUzmK86cntsfePdArwkCCar5lPdc5jqO69iXBfSSJpCKBPkqDK2pqIQ1y9K9tdQb0LZAQGZ1WqmzHuACvQECtfrih6rKh5Q2TdOV5w9NKquVxK7MEqCmToD+EgxqE5Va9ymOOD6tnMjOlzKMjruNv5bvj7stmySbcDwCak4QiESF3LE15QFjFrOHzBv2faBtnoBIDBk+W95pW7SgKyaQm5vGF8RM5W9CC6qVwlTeFN0QATzlWYr6jLb4J9Yafpk/zIzRsjJ+ej3f91zjc4vb9lhb49js0h+3PlHTQ6/vSK9PrqN/X+Ebhh+suA==, merchantReferenceCode=940937095, payerAuthEnrollReply_proofXML=<AuthProof><Time>2020 Jun 11 10:17:59</Time><DSUrl>https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/vereq.jsp?acqid=StandardCATestCases</DSUrl><VEReqProof><Message id=\"xcvwJJq7oeOPqQYcPfQ0\"><VEReq><version>1.0.2</version><pan>XXXXXXXXXXXX1111</pan><Merchant><acqBIN>12345678</acqBIN><merID>341422420000000</merID><password></password></Merchant><Browser><deviceCategory>0</deviceCategory></Browser></VEReq></Message></VEReqProof><VEResProof><Message id=\"xcvwJJq7oeOPqQYcPfQ0\"><VERes><version>1.0.2</version><CH><enrolled>Y</enrolled><acctID>3739974</acctID></CH><url>https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/pareq.jsp?vaa=b&amp;gold=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</url><protocol>ThreeDSecure</protocol></VERes></Message></VEResProof></AuthProof>, requestID=5918706794276852504009, payerAuthEnrollReply_acsURL=https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/pareq.jsp?vaa=b&gold=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, reasonCode=475, payerAuthEnrollReply_xid=eGN2d0pKcTdvZU9QcVFZY1BmUTA=]"
            },
            {
              "raw": "2020-06-11 18:18:01,183 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-23) 940937095: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test39, nttrefid=940937095, respcode=02, respdesc=Redirect To 3D Secure Page, proc_code=475, redirect_url=https://uat.ndhkpay.com/Ndhk_Api/threedsecure/redirecturl?s=ef0b2452d317dd017bf3a365938ef28d, date=2020-06-11 18:17:59, signature=120994c7c09f888ef1a156f8d3f3a5814a9d00ed95f194f961c7639f87985b67ec0e5b0e8128ef572615e7e2a80d2e8146ef8d91759c0931123ccbb628b52535, login=NTT, maskcardnumber=411111XXXXXX1111, isEnableRetry=null, authenticationStatus=Y, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-11 18:21:23,073 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940937095: Refund request from NTT_AUTO to NTT with 2899589650@210.3.198.58:NttRequest [refundrefnum=2899589650, login=NTT, pass=XXX, nttrefid=940937095, amt=100, signature=5fcf757078a0f8b9014a72ab0943bec448e1503b0bddb45026fdd678fa4921c093dca3cb8b2acc5a3a512f9757690b4cc6165e720922494e01dce36f97f9fe5b, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 18:21:23,097 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940937095: Refund response from NTT to NTT_AUTO with 2899589650@210.3.198.58:NttResponse [respcode=01, respdesc=Nonvoidable transaction status - pending transaction, signature=1e481d69d3a46bad5949ccdfe8773f17d9c1ba1455e214037f3feea346fb2c6ddf97b9a7f8d7fb49a72f1b3af4fa4deb23f0e852fa01a2e500f1439564952c70, isEnableRetry=null, errorCode=NE4021, errorDesc=Nonvoidable transaction status - pending transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4890",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "200",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "amt": "200",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "channelType": "cybs"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "amt": "100",
      "refundrefnum": "940890268_R111111111111111",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Invalid parameter - refundrefnum",
        "signature": true,
        "errorCode": "NE1042",
        "errorDesc": "Invalid parameter - refundrefnum"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "card_expirationMonth": "12",
              "raw": "2020-06-11 18:17:59,778 INFO  [com.nttdata.hk.secureManager.service.Impl.SecureCybersourceServiceImpl] (default task-23) 940937095: AuthEnroll request from NTT to cybs with HKD[payerAuthEnrollService_run=true, purchaseTotals_currency=HKD, card_expirationMonth=12, merchantReferenceCode=940937095, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-11 18:18:01,144 INFO  [com.nttdata.hk.secureManager.service.Impl.SecureCybersourceServiceImpl] (default task-23) 940937095: AuthEnroll response from cybs to NTT with HKD[payerAuthEnrollReply_proxyPAN=3739974, payerAuthEnrollReply_reasonCode=475, decision=REJECT, payerAuthEnrollReply_paReq=eNpVUstuwjAQvPsrItQzjkMgDVosQVHLQ6WhDZXg5jpbiNS8nITA39cO0IcP1s6udz0zNoQHhTh9Q1kr5PCMZSn2aMXRqHOSx2axKLwMX4JivZXB59rucAjGr1hwOKIq4yzlrGt3HaA3SPQIJQ8irTgIWUzmK86cntsfePdArwkCCar5lPdc5jqO69iXBfSSJpCKBPkqDK2pqIQ1y9K9tdQb0LZAQGZ1WqmzHuACvQECtfrih6rKh5Q2TdOV5w9NKquVxK7MEqCmToD+EgxqE5Va9ymOOD6tnMjOlzKMjruNv5bvj7stmySbcDwCak4QiESF3LE15QFjFrOHzBv2faBtnoBIDBk+W95pW7SgKyaQm5vGF8RM5W9CC6qVwlTeFN0QATzlWYr6jLb4J9Yafpk/zIzRsjJ+ej3f91zjc4vb9lhb49js0h+3PlHTQ6/vSK9PrqN/X+Ebhh+suA==, merchantReferenceCode=940937095, payerAuthEnrollReply_proofXML=<AuthProof><Time>2020 Jun 11 10:17:59</Time><DSUrl>https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/vereq.jsp?acqid=StandardCATestCases</DSUrl><VEReqProof><Message id=\"xcvwJJq7oeOPqQYcPfQ0\"><VEReq><version>1.0.2</version><pan>XXXXXXXXXXXX1111</pan><Merchant><acqBIN>12345678</acqBIN><merID>341422420000000</merID><password></password></Merchant><Browser><deviceCategory>0</deviceCategory></Browser></VEReq></Message></VEReqProof><VEResProof><Message id=\"xcvwJJq7oeOPqQYcPfQ0\"><VERes><version>1.0.2</version><CH><enrolled>Y</enrolled><acctID>3739974</acctID></CH><url>https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/pareq.jsp?vaa=b&amp;gold=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</url><protocol>ThreeDSecure</protocol></VERes></Message></VEResProof></AuthProof>, requestID=5918706794276852504009, payerAuthEnrollReply_acsURL=https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/pareq.jsp?vaa=b&gold=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, reasonCode=475, payerAuthEnrollReply_xid=eGN2d0pKcTdvZU9QcVFZY1BmUTA=]"
            },
            {
              "raw": "2020-06-11 18:18:01,183 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-23) 940937095: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test39, nttrefid=940937095, respcode=02, respdesc=Redirect To 3D Secure Page, proc_code=475, redirect_url=https://uat.ndhkpay.com/Ndhk_Api/threedsecure/redirecturl?s=ef0b2452d317dd017bf3a365938ef28d, date=2020-06-11 18:17:59, signature=120994c7c09f888ef1a156f8d3f3a5814a9d00ed95f194f961c7639f87985b67ec0e5b0e8128ef572615e7e2a80d2e8146ef8d91759c0931123ccbb628b52535, login=NTT, maskcardnumber=411111XXXXXX1111, isEnableRetry=null, authenticationStatus=Y, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-11 18:21:23,073 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940937095: Refund request from NTT_AUTO to NTT with 2899589650@210.3.198.58:NttRequest [refundrefnum=2899589650, login=NTT, pass=XXX, nttrefid=940937095, amt=100, signature=5fcf757078a0f8b9014a72ab0943bec448e1503b0bddb45026fdd678fa4921c093dca3cb8b2acc5a3a512f9757690b4cc6165e720922494e01dce36f97f9fe5b, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 18:21:23,097 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940937095: Refund response from NTT to NTT_AUTO with 2899589650@210.3.198.58:NttResponse [respcode=01, respdesc=Nonvoidable transaction status - pending transaction, signature=1e481d69d3a46bad5949ccdfe8773f17d9c1ba1455e214037f3feea346fb2c6ddf97b9a7f8d7fb49a72f1b3af4fa4deb23f0e852fa01a2e500f1439564952c70, isEnableRetry=null, errorCode=NE4021, errorDesc=Nonvoidable transaction status - pending transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4889",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "200",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "200",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "manualCapture": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code"
      ]
    },
    "refund": {
      "amt": "100",
      "refundrefnum": "",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Missing parameter - refundrefnum",
        "signature": true,
        "errorCode": "NE1041",
        "errorDesc": "Missing parameter - refundrefnum"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "card_expirationMonth": "12",
              "raw": "2020-06-11 18:17:59,778 INFO  [com.nttdata.hk.secureManager.service.Impl.SecureCybersourceServiceImpl] (default task-23) 940937095: AuthEnroll request from NTT to cybs with HKD[payerAuthEnrollService_run=true, purchaseTotals_currency=HKD, card_expirationMonth=12, merchantReferenceCode=940937095, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-11 18:18:01,144 INFO  [com.nttdata.hk.secureManager.service.Impl.SecureCybersourceServiceImpl] (default task-23) 940937095: AuthEnroll response from cybs to NTT with HKD[payerAuthEnrollReply_proxyPAN=3739974, payerAuthEnrollReply_reasonCode=475, decision=REJECT, payerAuthEnrollReply_paReq=eNpVUstuwjAQvPsrItQzjkMgDVosQVHLQ6WhDZXg5jpbiNS8nITA39cO0IcP1s6udz0zNoQHhTh9Q1kr5PCMZSn2aMXRqHOSx2axKLwMX4JivZXB59rucAjGr1hwOKIq4yzlrGt3HaA3SPQIJQ8irTgIWUzmK86cntsfePdArwkCCar5lPdc5jqO69iXBfSSJpCKBPkqDK2pqIQ1y9K9tdQb0LZAQGZ1WqmzHuACvQECtfrih6rKh5Q2TdOV5w9NKquVxK7MEqCmToD+EgxqE5Va9ymOOD6tnMjOlzKMjruNv5bvj7stmySbcDwCak4QiESF3LE15QFjFrOHzBv2faBtnoBIDBk+W95pW7SgKyaQm5vGF8RM5W9CC6qVwlTeFN0QATzlWYr6jLb4J9Yafpk/zIzRsjJ+ej3f91zjc4vb9lhb49js0h+3PlHTQ6/vSK9PrqN/X+Ebhh+suA==, merchantReferenceCode=940937095, payerAuthEnrollReply_proofXML=<AuthProof><Time>2020 Jun 11 10:17:59</Time><DSUrl>https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/vereq.jsp?acqid=StandardCATestCases</DSUrl><VEReqProof><Message id=\"xcvwJJq7oeOPqQYcPfQ0\"><VEReq><version>1.0.2</version><pan>XXXXXXXXXXXX1111</pan><Merchant><acqBIN>12345678</acqBIN><merID>341422420000000</merID><password></password></Merchant><Browser><deviceCategory>0</deviceCategory></Browser></VEReq></Message></VEReqProof><VEResProof><Message id=\"xcvwJJq7oeOPqQYcPfQ0\"><VERes><version>1.0.2</version><CH><enrolled>Y</enrolled><acctID>3739974</acctID></CH><url>https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/pareq.jsp?vaa=b&amp;gold=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA</url><protocol>ThreeDSecure</protocol></VERes></Message></VEResProof></AuthProof>, requestID=5918706794276852504009, payerAuthEnrollReply_acsURL=https://merchantacsstag.cardinalcommerce.com/MerchantACSWeb/pareq.jsp?vaa=b&gold=AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA, reasonCode=475, payerAuthEnrollReply_xid=eGN2d0pKcTdvZU9QcVFZY1BmUTA=]"
            },
            {
              "raw": "2020-06-11 18:18:01,183 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-23) 940937095: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test39, nttrefid=940937095, respcode=02, respdesc=Redirect To 3D Secure Page, proc_code=475, redirect_url=https://uat.ndhkpay.com/Ndhk_Api/threedsecure/redirecturl?s=ef0b2452d317dd017bf3a365938ef28d, date=2020-06-11 18:17:59, signature=120994c7c09f888ef1a156f8d3f3a5814a9d00ed95f194f961c7639f87985b67ec0e5b0e8128ef572615e7e2a80d2e8146ef8d91759c0931123ccbb628b52535, login=NTT, maskcardnumber=411111XXXXXX1111, isEnableRetry=null, authenticationStatus=Y, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-11 18:21:23,073 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940937095: Refund request from NTT_AUTO to NTT with 2899589650@210.3.198.58:NttRequest [refundrefnum=2899589650, login=NTT, pass=XXX, nttrefid=940937095, amt=100, signature=5fcf757078a0f8b9014a72ab0943bec448e1503b0bddb45026fdd678fa4921c093dca3cb8b2acc5a3a512f9757690b4cc6165e720922494e01dce36f97f9fe5b, isEnableRetry=false, refundMode=VOID, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-11 18:21:23,097 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-15) 940937095: Refund response from NTT to NTT_AUTO with 2899589650@210.3.198.58:NttResponse [respcode=01, respdesc=Nonvoidable transaction status - pending transaction, signature=1e481d69d3a46bad5949ccdfe8773f17d9c1ba1455e214037f3feea346fb2c6ddf97b9a7f8d7fb49a72f1b3af4fa4deb23f0e852fa01a2e500f1439564952c70, isEnableRetry=null, errorCode=NE4021, errorDesc=Nonvoidable transaction status - pending transaction]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4891",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-transaction_log",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "amt": "50",
      "refundrefnum": "123455-R1",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Provided refundrefnum already in use",
        "errorCode": "NE1090",
        "errorDesc": "Provided refundrefnum already in use"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "transaction_log": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "transaction_log",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {
              "currency": "HKD"
            }
          ]
        }
      }
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4888",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "amt": "0",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Requested amt is not in acceptable range",
        "errorCode": "NE1024",
        "errorDesc": "Requested amt is not in acceptable range"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4889",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "amt": "9999",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Refund amount exceeded the captured amount",
        "errorCode": "NE3019",
        "errorDesc": "Refund amount exceeded the captured amount"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4887",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "amt": "99999999999999999999",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Refund amount exceeded the captured amount",
        "errorCode": "NE3019",
        "errorDesc": "Refund amount exceeded the captured amount"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4885",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "amt": "ABC",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Invalid parameter - amt",
        "errorCode": "NE1023",
        "errorDesc": "Invalid parameter - amt"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4883",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "amt": null,
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Missing parameter - amt",
        "errorCode": "NE1022",
        "errorDesc": "Missing parameter - amt"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4881",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "amt": "100",
      "nttrefid": "ABCD",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Related transaction not found",
        "errorCode": "NE3022",
        "errorDesc": "Related transaction not found"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4880",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "refund": {
      "amt": "100",
      "nttrefid": null,
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Missing parameter - nttrefid OR txnid",
        "errorCode": "NE1019",
        "errorDesc": "Missing parameter - nttrefid OR txnid"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid} and rrn is not null"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4879",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "login": "NTT1",
      "amt": "100",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Invalid API credentials",
        "errorCode": "NE0100",
        "errorDesc": "Invalid API credentials"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4878",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "pass": "",
      "amt": "100",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Missing parameter - pass",
        "errorCode": "NE1013",
        "errorDesc": "Missing parameter - pass"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4876",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "N",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "success",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "N",
        "captureId": true,
        "manualCaptureStatus": "N",
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "login": "",
      "amt": "100",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Missing parameter - login",
        "errorCode": "NE1012",
        "errorDesc": "Missing parameter - login"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4875",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": true,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "refundRequestV3-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "refund": {
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Invalid request format",
        "errorCode": "NE1011",
        "errorDesc": "Invalid Request Format"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4806-1",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "Y",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "Transaction Authorization Succeeded",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "Y",
        "captureId": true,
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "amt": "300",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Partial void is not allowed",
        "errorCode": "NE3018",
        "errorDesc": "Partial void is not allowed"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  },
  {
    "testDataId": "Refundv2_NE_NDHK-4806-2",
    "OD": "QA_Automation",
    "merchantId": "nttauto",
    "Skip": false,
    "caseType": "NTT Error code Test Set",
    "testFlow": [
      "paymentRequest-auth",
      "refundRequestV2-refund",
      "frontend_cybsDB-refundtable",
      "frontend_cybsDB-logCheck"
    ],
    "auth": {
      "amt": "100",
      "txnid": "Refund_NE",
      "txncurr": "HKD",
      "carddata": "Sm6H/a13s+pi028W5nWa5y5Zyhr0F4RX2PIFgyDdgHM=|John Doe|CC|VISA",
      "authentication": "N",
      "manualCapture": "Y",
      "channelType": "cybs",
      "remarks": "remarks",
      "od": "od - uat testing",
      "udf1": "udf1 - uat",
      "udf2": "udf2 - uat",
      "udf3": "udf3 - uat",
      "udf4": "udf4 - uat",
      "udf5": "udf5 - uat",
      "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
      "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
      "paymentMethod": "credit",
      "expectedResult": {
        "httpCode": 200,
        "auth_code": "831000",
        "amt": "100",
        "txncurr": "HKD",
        "txnid": "Refund_NE",
        "respcode": "00",
        "respdesc": "Transaction Authorization Succeeded",
        "proc_code": "100",
        "login": "NTT_AUTO",
        "channelType": "cybs",
        "paymentMethod": "credit",
        "ru": "https://uat.ndhkpay.com/NTT_Pages/return",
        "callbackUrl": "https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec",
        "manualCapture": "Y",
        "captureId": true,
        "udf1": "udf1 - uat",
        "udf2": "udf2 - uat",
        "udf3": "udf3 - uat",
        "udf4": "udf4 - uat",
        "udf5": "udf5 - uat"
      },
      "needAssert": [
        "amt",
        "respcode",
        "respdesc",
        "proc_code",
        "channelType"
      ]
    },
    "refund": {
      "amt": "50",
      "expectedResult": {
        "respcode": "01",
        "respdesc": "Partial void is not allowed",
        "errorCode": "NE3018",
        "errorDesc": "Partial void is not allowed"
      },
      "needAssert": [
        "respcode",
        "respdesc",
        "errorCode",
        "errorDesc"
      ]
    },
    "refundtable": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "databaseQueries": {
          "dbQueryId": {
            "hostName": "uatDB",
            "databaseName": "pgdb",
            "tableName": "refund",
            "columnNames": [
              "currency"
            ],
            "queryType": "value",
            "conditionStrings": [
              "transaction_id = {nttrefid}"
            ]
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "databaseQueries": {
          "dbQueryId": [
            {}
          ]
        }
      }
    },
    "logCheck": {
      "body": {
        "login": "NTT",
        "signature": "1111111111111111111111",
        "signMix": [
          "nttrefid"
        ],
        "systemLogQueries": {
          "systemQuery1": {
            "logProvider": "splunk",
            "logGroup": "sg-uat-application",
            "logStream": "ip-172-20-42-187.ap-southeast-1.compute.internal/server.log",
            "startDateTime": "{{startDateTime}}",
            "endDateTime": "{{endDateTime}}",
            "query": "nttrefid",
            "columnNames": [
              "billTo_email",
              "card_expirationMonth"
            ],
            "conditionStrings": []
          }
        }
      },
      "expectedResult": {
        "signature": "aaded6743cdd206e264cf49272fbb6488d38cf37782a7a728703e14cf0a54595ba02144006620a2f5e9f412b06dc143585d5239af26c3ace660341e3448a6f9a",
        "systemLogQueries": {
          "systemQuery1": [
            {
              "billTo_email": "Ops.HK@nttdata.com",
              "card_expirationMonth": "12",
              "raw": "2020-06-16 11:08:21,859 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization request from NTT to cybs with HKD[purchaseTotals_currency=HKD, billTo_city=HK, billTo_email=Ops.HK@nttdata.com, merchantReferenceCode=940941447, billTo_country=HK, billTo_lastName=Hong Kong, billTo_postalCode=852, billTo_street1=Kings Road Quarry Bay, ccAuthService_run=true, purchaseTotals_grandTotalAmount=1.00, billTo_firstName=NTT Data, billTo_state=HK, card_expirationMonth=12, card_expirationYear=2020, card_accountNumber=411111XXXXXX1111]"
            },
            {
              "raw": "2020-06-16 11:08:23,254 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-17) 940941447: Authorization response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReply_processorResponse=00, ccAuthReply_avsCode=Y, decision=ACCEPT, ccAuthReply_reasonCode=100, merchantReferenceCode=940941447, ccAuthReply_authorizationCode=831000, ccAuthReply_reconciliationID=5922769023736306203009, ccAuthReply_amount=1.00, requestID=5922769023736306203009, ccAuthReply_authorizedDateTime=2020-06-16T03:08:22Z, reasonCode=100, ccAuthReply_avsCodeRaw=Y]"
            },
            {
              "raw": "2020-06-16 11:08:23,261 INFO  [com.nttdata.hk.processor.serivce.Impl.ProcessorDirectPaymentServiceImpl] (default task-17) CybersourcePaymentServiceImpl -  update transaction 940941447"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.business.utils.CommonUtil] (default task-17) #test391 - 940941447 Cvv removal : OK"
            },
            {
              "raw": "2020-06-16 11:08:23,285 INFO  [com.nttdata.hk.processor.DAO.Impl.RemoveCvvLogEAOImpl] (default task-17) Update remove cvv log table - nttrefid: 940941447"
            },
            {
              "raw": "2020-06-16 11:08:24,270 INFO  [com.nttdata.hk.api.utils.NttUtils] (default task-17) 940941447: Payment response from NTT to NTT_AUTO with HKD@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=Transaction Authorization Succeeded, proc_code=100, date=2020-06-16 11:08:21, signature=da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667, callbackUrl=https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec, login=NTT, channelType=cybs, fraudStatus=U, fraudResult={error={message=JSON malformed - no order root key}}, isEnableRetry=null, paymentMethod=credit, ru=https://uat.ndhkpay.com/NTT_Pages/return, manualCapture=Y, manualCaptureStatus=N, udf1=HIVE, udf2=PIG, udf3=SPARK, udf4=MAP-REDUCE, udf5=YARN, ]"
            },
            {
              "raw": "2020-06-16 11:08:24,271 INFO  [com.nttdata.hk.business.utils.CallbackExecutor] (common_util_thread17) Callback Json: {\"amt\":\"100\",\"txncurr\":\"HKD\",\"txnid\":\"test391\",\"nttrefid\":\"940941447\",\"respcode\":\"00\",\"respdesc\":\"Transaction Authorization Succeeded\",\"proc_code\":\"100\",\"date\":\"2020-06-16 11:08:21\",\"signature\":\"da9efe3affa2c28816514dfb78905bad8cb7d3d5f4b00ac1b4930f575bff331b082758fe8053f9e82fcc936e1d1c3bf3b14916ffaff668a81e584535af207667\",\"callbackUrl\":\"https://script.google.com/macros/s/AKfycbwRpCfYEQiDPGvCdE_mJXPWa9z42oSquQ4Ua5jQjd9B_k-L1wA/exec\",\"login\":\"NTT\",\"channelType\":\"cybs\",\"fraudStatus\":\"U\",\"fraudResult\":{\"error\":{\"message\":\"JSON malformed - no order root key\"}},\"paymentMethod\":\"credit\",\"ru\":\"https://uat.ndhkpay.com/NTT_Pages/return\",\"manualCapture\":\"Y\",\"manualCaptureStatus\":\"N\",\"udf1\":\"HIVE\",\"udf2\":\"PIG\",\"udf3\":\"SPARK\",\"udf4\":\"MAP-REDUCE\",\"udf5\":\"YARN\",\"auth_code\":\"831000\"}"
            },
            {
              "raw": "2020-06-16 11:09:56,840 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:09:56,866 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) start refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,872 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) 940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::GSTesting_940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,915 INFO  [com.nttdata.hk.utils.CommonRefundRequest] (default task-14) Refunddataarray::::::::940941447"
            },
            {
              "raw": "2020-06-16 11:09:56,932 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void request from NTT to cybs with HKD[purchaseTotals_currency=HKD, ccAuthReversalService_authRequestID=5922769023736306203009, merchantReferenceCode=GSTesting_940941447, ccAuthReversalService_run=true, purchaseTotals_grandTotalAmount=1.00]"
            },
            {
              "raw": "2020-06-16 11:09:58,204 INFO  [com.nttdata.hk.processor.cybersource.util.CybersourceUtils] (default task-14) 940941447: Void response from cybs to NTT with HKD[purchaseTotals_currency=HKD, ccAuthReversalReply_processorResponse=00, ccAuthReversalReply_requestDateTime=2020-06-16T03:09:57Z, ccAuthReversalReply_amount=1.00, decision=ACCEPT, merchantReferenceCode=GSTesting_940941447, requestID=5922769973316340903009, reasonCode=100, ccAuthReversalReply_reasonCode=100]"
            },
            {
              "raw": "2020-06-16 11:09:58,218 INFO  [com.nttdata.hk.api.mediator.RefundMediator] (default task-14) finish refund record processing 940941447"
            },
            {
              "raw": "2020-06-16 11:09:58,223 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-14) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [amt=100, txncurr=HKD, txnid=test391, nttrefid=940941447, respcode=00, respdesc=success, proc_code=100, signature=c12bed9e38a33087f65e91f3ac7f8608f2270ed1ae602dc12e0c0be04c2f0876d48cd152afa08e32c0cab4c7533dcc9edc2764bcca0635def985dfae84d907a9, isEnableRetry=null, refundRefNum=GSTesting_940941447, ]"
            },
            {
              "raw": "2020-06-16 11:14:07,996 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund request from NTT_AUTO to NTT with GSTesting_940941447@210.3.198.58:NttRequest [refundrefnum=GSTesting_940941447, login=NTT, pass=XXX, nttrefid=940941447, amt=100, signature=223f56aafa19de2b4b1798aafd360799ed662735ad26ba145f19e138c4a374ef0095102fbca14bf2d2f8e2f46a302f7c874a56c6bbbface3a6124eec69b9adef, isEnableRetry=false, isEnrollRecurring=false, ]]"
            },
            {
              "raw": "2020-06-16 11:14:08,019 INFO  [com.nttdata.hk.api.controller.RefundController] (default task-7) 940941447: Refund response from NTT to NTT_AUTO with GSTesting_940941447@210.3.198.58:NttResponse [respcode=01, respdesc=Provided refundrefnum already in use, signature=89e9c742a8e702334410c524f39d985b1067ab304bca91696569c5d9f9cbd6a3ec7da8566b976454cc7f13fe3021b13d8eff20f4ee4e72d03473c150958ca0b6, isEnableRetry=null, errorCode=NE1090, errorDesc=Provided refundrefnum already in use]"
            }
          ]
        }
      }
    }
  }
]